# 数据转发到MQ {#task_yvk_2c5_vdb .task}

您可以使用规则引擎，将物联网数平台据转发到消息队列（以下简称为MQ）中。从而实现消息从设备、物联网平台、MQ到应用服务器之间的全链路高可靠传输能力。

在设置转发之前，您需参考[设置数据流转规则](cn.zh-CN/用户指南/规则引擎/数据流转/设置数据流转规则.md#)，创建规则，编写用于处理数据的SQL。

本文仅介绍数据转发中的添加操作。

1.  在规则详情页，单击**数据转发**一栏的**添加操作**。 
2.  在添加操作对话框中，选择操作为**发送数据到消息队列\(Message Queue\)中**，并按照界面提示，设置参数。 

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/7544/15475343802637_zh-CN.png)

    |参数|说明|
    |:-|:-|
    |选择操作|数据转发目标云产品。选择为发送数据到消息队列\(Message Queue\)中|
    |地域|选择MQ Topic所在地域。|
    |Topic|选择写入物联网平台备数据的MQ Topic。若无Topic，请单击**创建Topic**在消息队列控制台，创建用于接收物联网平台数据的Topic。

|
    |Tag（可选）|设置标签。设置标签后，所有通过该操作流转到MQ对应Topic里的消息都会携带该标签。您可以在MQ消息消费端，通过标签进行消息过滤。

标签长度限制为128字节。可以输入常量或变量。变量格式为$\{key\}，代表SQL处理后的JSON数据中key对应的value值。

|
    |授权|授予物联网平台数据写入MQ的权限。如您还未创建相关角色，请单击**创建RAM角色**进去RAM控制台，创建角色和授权策略。如需帮助，请参见[管理 RAM 角色](https://help.aliyun.com/document_detail/93691.html)。

|


规则启动之后，物联网平台即可将数据写入MQ的Topic，您可以使用MQ实现消息收发，具体使用方法，请参考[MQ订阅消息](https://help.aliyun.com/document_detail/34411.html)。

